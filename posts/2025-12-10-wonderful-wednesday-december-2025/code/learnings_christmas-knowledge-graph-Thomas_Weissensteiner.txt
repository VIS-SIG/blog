â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

SETUP FOR AI-ASSISTED GENERATION OF THE KNOWLEDGE GRAPH
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

The graph was created with the help of Claude Sonnet 4.5 (claude.ai). 
Claude`s web-artifacts-builder and canvas-design skills were not enabled 
(https://claude.ai/settings/capabilities)

Prompt for initiating the project:
"I would like to generate an interactive knowledge graph. 
The theme is popular Christmas traditions around the world, their historical 
origins, relationships with each other, and other contemporary customs.
Interactive features could include 
â€¢ links to online information when the cursor hovers of a node
â€¢ options to customise the graph: selecting node categories (persons, places, 
  traditions, etc.), changing edge distance, etc.
Please 
â€¢ add suggestions for content and visualisation (bullet point list, minimal details)
â€¢ sketch a strategy for implementation, including programming language(s) and packages 
  best suited for the task, and a bullet-point outline of the essential tasks involved 
  in building the knowledge graph"

Prompt for restarting the conversation in a new chat (start with project description 
as above):
"Attached is a draft version. Please check the code for robustness and efficiency. 
Remove any parts that are obsolete and suggest improvements"

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

GENERAL PRINCIPLES LEARNED
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 

1. AI-ENABLED GENERATION OF AN INTERACTIVE VISUALISATION WITHOUT KNOWLEDGE 
   OF PROGRAMMING LANGUAGES 
   The user was able to generate an interactive graph for web browsers without 
   knowledge of HTML, CSS, and Java languages, and their software packages

2. START WITH A SIMPLIFIED VERSION
   â€¢ Sketch the main visual elements and interactions
   â€¢ Test how it works
   â€¢ Add more sophisticated features step-by-step.

3. USE CONSOLE MESSAGES TO AID THE AI WITH DEBUGGING
   â€¢ Reporting Java console error messages as well as unexpected behaviour lets the AI 
     resolve issues faster 
   â€¢ To access Java console, right-click on the browser window, choose "Inspect" from
     the pop-up menu to open the side panel, click on "Console" in the side panel menu
   â€¢ If the error names a line of code where the bug is located, open "Source" in the 
     side panel to look it up

4. INCREMENTAL DEBUGGING
  â€¢ Add features one at a time. When stuck, revert to last working version. 
  â€¢ If the AI still gets caught in a loop ("context poisoning"?), start a new thread.

5. SIMPLICITY WINS
   â€¢ Complex state management consistently led to bugs, simpler solutions are easier to
     maintain and debug
   â€¢ Let D3 force simulation handle physics - avoid over-controlling it

6. ORDER MATTERS
   â€¢ JavaScript/React initialization order is critical - declare before use
   â€¢ Never set fx/fy before x/y exist: respect simulation lifecycle

7. DIRECT MANIPULATION
   Force-graph library mutates node objects in place - work with them directly

8. EMBRACE PLATFORM BEHAVIORS
   â€¢ Ask AI to check browser compatibility
   â€¢ When accessing links, work with browser policies (autoplay, cookies) not against them

9. SEPARATION OF CONCERNS
   Canvas for performance-critical rendering, DOM for rich interactive content

10. USER INSIGHTS MATTER
   Claude found many relevant web sources, but editing the information displayed in the graph was 
   still a major part of the user input.
   Consider the AI a subject matter expert for implementing and explaining code, but even here 
   do not assume it has all the answers, e.g.: 
   â€¢ Claude assumed the existence of API methods that do not exist (clues for this were found in 
     the console messages)
   â€¢ we got into a loop of abortive attempts to debug an issue that made the code more and more 
     complicated and unreliable, but user experience of the graph led to a simple and robust solution

11. REVISE CODE PERIODICALLY DURING ITS EVOLUTION
    Ask the AI to check for code for robustness, efficiency, and maintainability. 
    Remove any parts that may have become obsolete during the previous editing cycles.
    If the AI suggests substantial refactoring, it is likely that this will help the 
    subsequent development.

12. USE AI FOR PROJECT DOCUMENTATION
    â€¢ When the code is finalized ask AI to add annotations prepare a "ReadMe" manual
    â€¢ Turn project into a learning experience: ask for a draft summary of major challenges, 
      solutions and key insights gained


â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

LEARNINGS FROM DEBUGGING PROJECT-SPECIFIC ISSUES
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”


1. INITIALIZATION & RENDER LOOP ISSUES

Problem: Graph appeared briefly and vanished, or page completely blank

Root Causes:
â€¢ Variable accessed before declaration (nodePositions referenced before defined)
â€¢ Calling graphRef.current.graphData() as function (it's a property)
â€¢ useEffect running before nodes had coordinates (fx/fy on undefined values)
â€¢ Missing useMemo causing infinite re-renders

Solution:
â€¢ Strict declaration order: refs â†’ state â†’ constants â†’ effects â†’ functions
â€¢ Work directly with filteredData.nodes instead of trying to access nodes though graphRef.current.graphData()
â€¢ Ensure fx/fy only set when x/y !== undefined
â€¢ Add useMemo for filtered data calculations


2. NODE PINNING & FORCE SIMULATION

Problem: Nodes drifting on cursor hover, making tooltips unreadable and links unclickable
Root Cause: Force simulation running indefinitely without pinning nodes
Solution: Pin nodes when simulation stops:
```javascript
const handleEngineStop = () => {
    filteredData.nodes.forEach(node => {
        node.fx = node.x;
        node.fy = node.y;
    });
};
``` 
Insight: Work directly with node objects in filteredData - the library mutates them in place


3. POSITION LOADING & CUSTOM LAYOUT

Aim: Nodes arranged in custom star shape on initialization, staying fixed until user interaction
Solution: Simple useEffect after data loads (complex state management led to bugs)
```javascript
useEffect(() => {
    const hasPositions = Object.keys(nodePositions).length > 0;
    if (hasPositions && filteredData.nodes.length > 0) {
        filteredData.nodes.forEach(node => {
            if (nodePositions[node.id]) {
                node.x = nodePositions[node.id].x;
                node.y = nodePositions[node.id].y;
                node.fx = nodePositions[node.id].x;  // Fixed
                node.fy = nodePositions[node.id].y;
            }
        });
    }
}, [filteredData, nodePositions]);
```

For the arrangement of nodes in star shape:
1. Added a temporary button for JAVA console export
2. Manually arranged nodes, exported position to console
3. Copied positions, fed them back to AI, removed export button


4. LINK DISTANCE SLIDER ISSUES

Problem 1: Once nodes were pinned, link distance slider had no effect
Root Cause: Pinned nodes (fx/fy set) ignore force simulation changes
Problem 2: Slider stopped working after deselecting/reselecting categories
Root Cause: Nodes remained pinned through category filter changes
Solution: Unpin nodes when slider moves (user suggestion)
```javascript
useEffect(() => {
    if (!graphRef.current) return;
    
    const graph = graphRef.current;  
    const linkForce = graph.d3Force('link');
    
    if (linkForce) {
        if (linkDistance !== 100 && filteredData.nodes.length > 0) {
            filteredData.nodes.forEach(node => {
                node.fx = null;
                node.fy = null;
            });
        }
        linkForce.distance(linkDistance);
        graph.d3ReheatSimulation();
    }
}, [linkDistance, filteredData]);
```


5. API METHOD CONFUSION

Problem: AI attempted to use non-existent ForceGraph2D methods during debugging:
â€¢ graphRef.current.graphData() (a property, not a method)
â€¢ graphRef.current.refresh()

Correct API Methods:
âœ“ graphRef.current.d3Force('link') - access force simulation
âœ“ graphRef.current.d3ReheatSimulation() - restart simulation
âœ“ Direct node property manipulation (node.fx, node.fy)

Solution: AI checked library documentation to confirm API methods exist


6. VISUALIZATION FEATURES

Aim: Show second degree connections between filtered nodes
Solution: findIndirectConnections() algorithm:
â€¢ Build adjacency map of all connections in full graph
â€¢ For each visible node pair, check if they share hidden neighbors
â€¢ Create dashed links: linkLineDash: [5, 5]

Aim: Represent nodes belonging to multiple categories.
Solution: Custom drawMultiColorStar() function:
â€¢ Calculate points per category: 1 cat = 5 points, 2 cats = 8 points (4 each), 3 cats = 9 points (3 each)
â€¢ Draw each spike individually with category color
â€¢ Cycle through categories using Math.floor(i / pointsPerCategory)

Problem: Country flags displayed as letter codes instead of emojis 
Solution:
â€¢ Use Unicode flag emoji characters directly: ğŸ‡©ğŸ‡ª ğŸ‡¬ğŸ‡§ ğŸ‡³ğŸ‡± ğŸ‡®ğŸ‡¹ ğŸ‡ºğŸ‡¸
â€¢ Emojis display in hover panel (DOM) not canvas
â€¢ Conditional rendering for URL vs character emojis
Key Learning: Canvas vs DOM - use canvas for performance, DOM for rich content


Aim: Shooting star animation - add ambient background without affecting graph performance
Solution:
â€¢ Separate React component with own state
â€¢ CSS animations (hardware-accelerated) not JavaScript
â€¢ Random timing with setTimeout cleanup
â€¢ Absolute positioning with high z-index layering


7. BACKGROUND MUSIC (not implemented in the final graph)

Issue: 
â€¢ Embedded YouTube player requires cookie acceptance
â€¢ Play button unresponsive until cookie decision
â€¢ Cannot legally automate consent (GDPR violation)

Solution: Replaced YouTube with HTML5 audio player
â€¢ Replace YouTube with HTML5 audio player
â€¢ Stream MP3 from GitHub repository

Issue: Modern browsers block autoplay-with-sound by default (intentional browser security)
Solution: Embrace browser behavior
â€¢ Keep autoPlay: true attribute (may work in some cases)
â€¢ Provide clear Play button as primary control


â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

OVERALL ARCHITECTURE
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

TECHNOLOGY STACK:
â€¢ React 18 for UI controls and state management
â€¢ react-force-graph-2d for graph visualization
â€¢ D3 force simulation for physics
â€¢ Canvas for high-performance node rendering
â€¢ HTML5 Audio API for music playback

STATE MANAGEMENT STRATEGY:
â€¢ React state for UI interactions
â€¢ useRef for DOM references and image cache
â€¢ useMemo for expensive computations (filtered data, stats)
â€¢ useEffect for side effects (images, positions)

DATA STRUCTURE:
â€¢ Nodes with flexible category system (single or array)
â€¢ Links with source/target relationships
â€¢ Pre-computed positions for deterministic layout

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

FINAL STATISTICS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

PROJECT SCOPE:
â€¢ 43 nodes (Christmas traditions, people, places, symbols, foods)
â€¢ 59 edges (relationships between concepts)
â€¢ 7 categories
â€¢ 6 relationship types
â€¢ Custom star pattern layout with 43 pre-computed positions
â€¢ Multi-category node visualization
â€¢ Indirect connection discovery
â€¢ Filtering and highlighting systems

LINES OF CODE: ~1,300 lines (HTML, CSS, JavaScript, React)

DEVELOPMENT TIME: Multiple iterative sessions across 3 major stages

MAJOR REWRITES: 3-4 complete refactors to resolve fundamental issues

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

